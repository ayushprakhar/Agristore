@model ProductDisplayModel
@{

}
@* <div class="my-2">
    <form asp-action="Index" class="row row-cols-lg-auto g-3 align-items-center">
        <div class="col-12">
            <label class="visually-hidden" for="CategoryId">Categories</label>
            <select class="form-select" id="CategoryId" name="CategoryId">
                <option selected>Category</option>
                @foreach (var Category in Model.Categories)
                {
                    <option selected="@(Category.Id == Model.CategoryId)" value="@Category.Id">@Category.CategoryName</option>
                }
            </select>
        </div>

        <div class="col-12">
            <label class="visually-hidden" for="sterm">Search by title</label>
            <div class="input-group">
                <div class="input-group-text"></div>
                <input type="text" class="form-control" value="@Model.STerm" id="sterm" name="sterm" placeholder="Sarch by title">
            </div>
        </div>

        <div class="col-12">
            <button type="submit" class="btn btn-primary">Search</button>
            <a href="/Home/Index" class="btn btn-dark">Reset</a>
        </div>
    </form>
</div> *@
<br />
@* <div class="container">

    <div class="row justify-content-center">

        <div class="col-md-8">

            <div class="input-group mb-3">
                <label class="visually-hidden" for="sterm">Search by title</label>
                <input type="text" class="form-control input-text" placeholder="Search products...." aria-label="Recipient's username" aria-describedby="basic-addon2">
                <div class="input-group-append">
                    <button class="btn btn-outline-success btn-lg" type="button"><i class="fa fa-search"></i></button>
                </div>
            </div>

        </div>

    </div>

</div> *@

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <form asp-action="Index" class="input-group mb-3">

                <label class="visually-hidden" for="sterm">Search by title</label>
                <input type="text" class="form-control input-text" value="@Model.STerm" id="sterm" name="sterm" placeholder="Search products...." aria-label="Recipient's username" aria-describedby="basic-addon2">
                <div class="input-group-append">
                    <button type="submit" class="btn btn-outline-success btn-lg"><i class="fa fa-search"></i></button>
                </div>
            </form>
        </div>
    </div>
</div>

@* <div class="w-100 mt-4 d-flex flex-wrap ">
    @foreach (var Product in Model.Products)
    {
        <a href="@Url.Action("Details", "Home", new { id = Product.Id })" class="text-decoration-none text-dark">
        <div class="card mx-3 mb-4" style="width: 11rem;">
            @if (string.IsNullOrEmpty(Product.Image))
            {
                <img style="width:100%;height:180px" src="/images/NoImage.png" class="card-img-top" alt="...">

            }
            else
            {
                <img style="width:100%;height:180px" src="/images/@Product.Image" class="card-img-top" alt="...">
            }
            <div class="card-body">
                <h5 class="card-title">@Product.ProductName</h5>
                <p class="card-text">
                    <b>Category: </b>@Product.CategoryName <br />
                    <b>Brand: </b>@Product.BrandName <br />
                    <b>Price: </b>@Product.Price
                </p>
                <button type="button" onclick="add(@Product.Id)" class="btn btn-primary">Add to cart</button>
            </div>
        </div>
        </a>
    }
</div> *@




<section style="background-color: #eee;">
    <div class="container py-5">
        @foreach (var Product in Model.Products)
        {


        <div class="row justify-content-center mb-3">
            <div class="col-md-12 col-xl-10">
                <div class="card shadow-0 border rounded-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-12 col-lg-3 col-xl-3 mb-4 mb-lg-0">
                                <div class="bg-image hover-zoom ripple rounded ripple-surface">
                                        <img src="/images/@Product.Image" class="w-100" />
                                        <a href="@Url.Action("Details", "Home", new { id = Product.Id })">
                                            <div class="hover-overlay">
                                                <div class="mask" style="background-color: rgba(253, 253, 253, 0.15);"></div>
                                            </div>
                                        </a>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-6 col-xl-6">
                                <h5>@Product.ProductName</h5>
                                <div class="d-flex flex-row">
                                    <div class="text-danger mb-1 me-2">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    <span>310</span>
                                </div>
                                <div class="mb-2 text-muted small">
                                        <span>@Product.BrandName</span>
                                        <span class="text-primary"> • </span>
                                        <span>@Product.CategoryName</span>
                                </div>
                                <p class="text-truncate mb-4 mb-md-0">
                                    There are many variations of passages of Lorem Ipsum available, but the
                                    majority have suffered alteration in some form, by injected humour, or
                                    randomised words which don't look even slightly believable.
                                </p>
                            </div>
                                <div class="col-md-6 col-lg-3 col-xl-3 border-sm-start-none border-start">
                                    <div class="d-flex flex-row align-items-center mb-1">
                                        <h4 class="mb-1 me-1">@Product.Price.ToString("C")</h4>
                                    </div>
                                    <h6 class="text-success">Free shipping</h6>
                                    <div class="d-flex flex-column mt-4">
                                        <a href="@Url.Action("Details", "Home", new { id = Product.Id })" class="btn btn-primary btn-sm ">
                                        <button data-mdb-button-init data-mdb-ripple-init class="btn btn-primary btn-sm" type="button">Details</button>
                                        </a>
                                        <button data-mdb-button-init data-mdb-ripple-init class="btn btn-outline-primary btn-sm mt-2" type="button" onclick="add(@Product.Id)">
                                            Add to cart
                                        </button>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        }
        </div>
    </div>
</section>







@section Scripts{
    <script>
        async function add(ProductId) {
             var usernameEl = document.getElementById("username");
        if(usernameEl==null){
            window.location.href = "/Identity/Account/Login";
          //var username=usernameEl.innerText;
          //  if(username.length<1){
          //      window.location.href="/Identity/Account/Login";
          //  }
        }
            try {
                var response = await fetch(`/Cart/AddItem?ProductId=${ProductId}`);
                if (response.status == 200) {
                    var result = await response.json();
                    var cartCountEl = document.getElementById("cartCount");
                    cartCountEl.innerHTML = result;
                    window.location.href = "#cartCount";
                }
            }
            catch (err) {
                console.log(err);
            }
        }
    </script>
}


